# Values defined here override any values defined in deployment.yml
---
components:
  be:
    environment:
      nginx_host_port: 3000
    components:
      infra:
        config:
          cluster:
            type: instance
        components:
          vpc:
            config:
              provider: aws
              name: demo-development
              cidr: "10.8.0.0/16"
          instance:
            config:
              provider: aws
              name_prefix: dev
              ec2_key_pair: demo_admin
          dns:
            config:
              root_domain: demo.cnfs.io
              sub_domain: development
              root_domain_managed_in_route53: yes
          cert:
            config:
              provider: aws
              subject_alternative_names: []
          cdn:
            config:
              provider: aws
            components:
              # name will be used to compose the full dns name
              cdn:
                enabled: yes
                bucket: cdn
                url: https://cdn.uat.whistler.perxtech.io
          object_storage:
            config:
              provider: aws
            components:
              app:
                services: ['documents', 'reports', 'sftp']
              cdn:
                services: ['images']
      application:
        config:
          feature_set: mounted
          feature_from_branch: no
        environment:
          bucket_endpoint_url: http://localstack:4572
          aws_access_key_id: this_key_from_development_yml
          aws_secret_access_key: this_key_from_development_yml
        components:
          services:
            components:
              fluentd:
                config:
                  enabled: no
              kafkastack:
                config:
                  enabled: no
              localstack:
              nginx:
              postgres:
              redis:
              sftp:
                environment:
                  bucket_prefix: storage
              wait:

          platform:
            environment:
              redis_url: redis://redis:6379
              platform:
                request_logging:
                  enabled: no
                event_logging:
                  enabled: no
                infra:
                  services:
                    storage:
                      aws:
                        endpoint: http://localstack:4572
                        force_path_style: yes
                        region: ap-southeast-1
                    mq:
                      aws:
                        endpoint: http://localstack:4576
                        verify_checksums: no
                        region: ap-southeast-1
                  # resources:
                  #   storage:
                  #     primary:
                  #       provider: aws
                  #       enabled: yes
                  #   mq:
                  #     primary:
                  #       provider: aws
            components:
              cognito:
                config:
                  profiles: ['server']
              comm:
                config:
                  profiles: ['server']
              iam:
                config:
                  profiles: ['server']
              organization:
                config:
                  profiles: ['server']
              storage:
                environment:
                  platform:
                    infra:
                      resources:
                        mq:
                          primary:
                            enabled: yes
                            queue_name: storage-sftp-home
