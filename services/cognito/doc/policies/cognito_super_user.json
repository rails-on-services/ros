{ "name": "CognitoPowerUser",
  "description": "Provides administrative access to existing Amazon Cognito resources",
  "version": "1",
  "rules": [
    {
      "description": "Allow owners to read their account",
      "effect": "allow",
      "action": ["cognito:read"],
      "resource": "urn:perx:cognito::user",
      "conditions": [
        {
          "equal": {
            "user::id": ["resource::id"]
          }
        }
      ]
    },
    {
      "description": "Allow authors to read, write, and sell their books",
      "effect": "allow",
      "action": ["sell"],
      "resource": "Iam::User",
      "conditions": [
        {
          "equal": {
            "resource::id": ["user::id"]
          }
        }
      ]
    },
    {
      "description": "Disallow users from writing books in languages they do not speak",
      "effect": "deny",
      "resource": "Iam::User",
      "action": ["write"],
      "conditions": [
        {
          "not_equal": {
            "resource::time_zone": ["user::time_zone"]
          }
        }
      ]
    },
    {
      "description": "Allows users to borrow books from friendly users",
      "effect": "allow",
      "resource": "Iam::User",
      "action": ["borrow_book"]
    }
  ]
}
